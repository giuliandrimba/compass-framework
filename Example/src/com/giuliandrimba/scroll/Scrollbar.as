package com.giuliandrimba.scroll{	import flash.display.MovieClip;	import flash.display.Stage;	import flash.events.EventDispatcher;	import flash.events.MouseEvent;	import flash.events.Event;	import flash.geom.Rectangle;	import com.greensock.TweenLite;	import com.greensock.easing.Quad;		public class Scrollbar extends EventDispatcher	{		private var _content:MovieClip;		private var _scrollBar:MovieClip;		private var _scroller:MovieClip;		private var _scrollArea:MovieClip;		private var _contentMask:MovieClip;		private var _stage:Stage;				private var _scrolledArea:Number;		private var _percentScrolled:Number;		private var _contentRestArea:Number;		private var _scrollerArea:Number		public static const SCROLLING:String = "scrolling";				public function Scrollbar($content:MovieClip,$contentMask:MovieClip, $scrollbar:MovieClip, $scroller:MovieClip, $scrollArea:MovieClip)		{			_content = $content;			_scrollBar = $scrollbar;			_scroller = $scroller;			_scrollArea = $scrollArea;			_contentMask = $contentMask;						_scroller.buttonMode = true;		}				public function init():void		{			verifyScroll();			_scroller.addEventListener(MouseEvent.MOUSE_DOWN, thumbDown);						_scroller.y = 0;			_content.y = 0;		}		private function verifyScroll():void		{			if (_content.height <= _contentMask.height)			{				_scrollBar.visible = false;			}			else {				_scrollBar.visible = true;			}		}		private function thumbDown(e:MouseEvent):void		{			_scroller.addEventListener(Event.ENTER_FRAME, onEnterFrameEvent);			_content.stage.addEventListener(MouseEvent.MOUSE_UP, thumbUp);		}				private function onEnterFrameEvent(e:Event):void 		{			dispatchEvent(new Event(SCROLLING))			thumbMove();		}		private function thumbUp(e:MouseEvent):void		{			_scroller.removeEventListener(Event.ENTER_FRAME, onEnterFrameEvent);			_content.stage.removeEventListener(MouseEvent.MOUSE_UP, thumbUp);			_scroller.stopDrag();					}				private function thumbMove(e:MouseEvent=null):void		{			dragscroller();			TweenLite.to(_content,0.3,{y:scrollObject(),ease:Quad.easeOut});		}				private function scrollObject():Number		{			_scrolledArea = _scroller.y;			_scrollerArea = _scrollArea.height - _scroller.height			_percentScrolled = (_scrolledArea * 100)/_scrollerArea;			_contentRestArea = _content.height - _contentMask.height;			var scroller:Number = (_contentRestArea * _percentScrolled) / 100;			return -scroller;		}		private function dragscroller():void		{			var rheight:Number = _scrollBar.height - _scroller.height			_scroller.startDrag(false, new Rectangle(_scrollArea.x, _scrollArea.y, 0, rheight));		}				//SET GET		public function set contentObject (pValue:MovieClip):void		{			_content = pValue;		}		public function get contentObject ():MovieClip		{			return _content;		}		public function set scrollBar (pValue:MovieClip):void		{			_scrollBar = pValue;		}		public function get scrollBar():MovieClip		{			return _scrollBar;		}		public function set scroller (pValue:MovieClip):void		{			_scroller = pValue;		}		public function get scroller ():MovieClip		{			return _scroller;		}		public function set scrollArea (pValue:MovieClip):void		{			_scrollArea = pValue;		}		public function get scrollArea ():MovieClip		{			return _scrollArea;		}		public function set contentObjectMask (pValue:MovieClip):void		{			_contentMask = pValue;		}		public function get contentObjectMask():MovieClip		{			return _contentMask;		}	}}